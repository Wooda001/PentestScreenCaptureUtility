#!/usr/bin/env python3
import importlib.util
from sys import modules
from time import sleep

requirements_list = ['pyautogui', 'subprocess']
missing_list = []

#reference for this method of module detection taken from: https://stackoverflow.com/questions/1051254/check-if-python-package-is-installed
for i in requirements_list:
    if i not in modules:
        missing_list.append(i)

try:
    # the following method was taken from: https://stackoverflow.com/questions/12332975/installing-python-module-within-code
    from subprocess import check_call
    from sys import executable as ex
    for i in missing_list:
        check_call([ex, "-m", "pip", "install", f"{str(i)}", "--user"])
except ImportError:
    from os import sys, executable
    for i in missing_list:
        sys(f"{executable} -m pip install {str(i)} --user
            
import pyautogui
count = 0
#Replace with directory to write to:
directory = r'C:/Users/Me/Documents/' 
while count < 100:
    myScreenshot = pyautogui.screenshot()
    myScreenshot.save(directory + 'image' + str(count) + '.png')
    count += 1
    sleep(1)
